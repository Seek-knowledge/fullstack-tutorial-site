<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、Docker 快速入门 | Full Stack Developer Tutorial</title>
    <meta name="description" content="from zero to hero">
    <link rel="icon" href="/fullstack-tutorial-site/favicon.ico">
    
    <link rel="preload" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css" as="style"><link rel="preload" href="/fullstack-tutorial-site/assets/js/app.e23029aa.js" as="script"><link rel="preload" href="/fullstack-tutorial-site/assets/js/17.f0e20aa7.js" as="script"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/10.styles.e7bfa7b0.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/7.styles.a8031ade.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/1.82e55b14.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/10.e7bfa7b0.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/11.42acfd5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/12.f0884d8e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/13.c57f5837.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/14.07fd252d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/15.9dcc583e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/16.42bd51ad.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/18.62b756df.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/19.732a8ec2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/2.57da3069.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/20.1cd96f80.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/21.e3ef896c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/22.8dd77b6a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/23.5ae08c37.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/24.5a34ccb1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/25.7dee6df6.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/26.af9b2812.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/27.6f5b260d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/28.c5f782da.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/29.799a3dea.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/3.4193afeb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/30.8bb33866.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/31.a2bf48a5.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/32.2dd32760.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/33.8b1034f7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/34.8e3964bc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/35.57d9f500.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/36.49aead0e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/37.60183b23.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/38.3416c1ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/39.cc8bcef9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/4.020e03fa.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/40.ffb34422.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/41.feec12a7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/42.4e1803cc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/43.6a56bbfb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/44.ef11fafe.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/45.6b3189d2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/46.cf48bc8c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/47.bbcdd89a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/48.9ad3fe5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/49.c4eb64f9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/5.f4777b53.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/50.79d979ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/51.bee6678b.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/52.5e069c45.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/53.b4ed7749.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/54.37b05d6c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/55.9497455f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/56.7459f398.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/57.a21a8691.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/58.5c0b7c68.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/59.083c760f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/6.0c32f6b7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/60.881f6ac9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/61.ebc72343.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/62.3514484e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/63.39076018.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/64.20372ac4.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/65.cc25487c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/66.e130b690.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/67.40d544ec.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/68.371c66ba.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/69.bf625d87.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/7.a8031ade.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/70.53616ef1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/71.1e855d2c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/72.ebb7d332.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/73.7b72b76a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/74.7f93f494.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/8.27947311.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/9.ca56268b.js">
    <link rel="stylesheet" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fullstack-tutorial-site/" class="home-link router-link-active"><!----> <span class="site-name">Full Stack Developer Tutorial</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">全栈指南</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link">场景实战</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">捐赠</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">作者</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择/语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/Docker基础.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">全栈指南</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link">场景实战</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">捐赠</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">作者</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择/语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/Docker基础.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><div id="codefund_ad"></div></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Get Start</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/" class="sidebar-link">快速开始</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Java 技术栈</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/01 Java 基础.html" class="sidebar-link">Java 基础概念</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java 集合框架.html" class="sidebar-link">Java 集合框架</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/03 Java 并发编程.html" class="sidebar-link">Java 并发编程</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/04 Java IO.html" class="sidebar-link">Java I/O</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/05 Java 虚拟机.html" class="sidebar-link">Java 虚拟机</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/07 Java Web.html" class="sidebar-link">Java Web</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>数据库</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/MySQL.html" class="sidebar-link">前言</a></li><li><a href="/fullstack-tutorial-site/notes/SQL.html" class="sidebar-link">前言</a></li><li><a href="/fullstack-tutorial-site/notes/Redis.html" class="sidebar-link">前言</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><ul><li><a href="#%E4%B8%80docker-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">一、Docker 快速入门</a> <ul><li><a href="#%E5%88%9D%E6%8E%A2-docker">初探 Docker</a> <ul><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-docker">什么是 Docker</a></li> <li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8-docker">为什么要使用 Docker</a></li></ul></li> <li><a href="#centos-7-%E5%AE%89%E8%A3%85-docker">CentOS 7 安装 Docker</a></li> <li><a href="#docker-%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E5%99%A8">Docker 镜像加速器</a></li> <li><a href="#docker-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">Docker 常用命令</a> <ul><li><a href="#1-%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1">1. 启动、停止、重启服务</a></li> <li><a href="#2-%E6%8B%89%E5%8F%96%E4%B8%80%E4%B8%AA%E9%95%9C%E5%83%8F%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8">2. 拉取一个镜像，启动容器</a></li> <li><a href="#3-%E5%90%AF%E5%8A%A8%E7%9A%84%E5%AE%B9%E5%99%A8%E5%88%97%E8%A1%A8">3. 启动的容器列表</a></li> <li><a href="#4-%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%9A%84%E5%AE%B9%E5%99%A8">4. 查看所有的容器</a></li> <li><a href="#5-%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E9%87%8D%E5%90%AF%E6%9F%90%E4%B8%AA%E5%AE%B9%E5%99%A8">5. 启动、停止、重启某个容器</a></li> <li><a href="#6-%E6%9F%A5%E7%9C%8B%E6%8C%87%E5%AE%9A%E5%AE%B9%E5%99%A8%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95">6. 查看指定容器的日志记录</a></li> <li><a href="#7-%E5%88%A0%E9%99%A4%E6%9F%90%E4%B8%AA%E5%AE%B9%E5%99%A8%E8%8B%A5%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E9%9C%80%E8%A6%81%E5%85%88%E5%81%9C%E6%AD%A2">7. 删除某个容器，若正在运行，需要先停止</a></li> <li><a href="#8-%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8">8. 删除容器</a></li> <li><a href="#9-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F">9. 删除镜像</a></li> <li><a href="#10-%E5%88%A0%E9%99%A4%E8%99%9A%E6%82%AC%E9%95%9C%E5%83%8F">10. 删除虚悬镜像</a></li> <li><a href="#11-%E9%95%9C%E5%83%8F%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA">11. 镜像导入与导出</a></li></ul></li></ul></li> <li><a href="#%E4%BA%8Cdocker-file-%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA">二、Docker File 镜像构建</a></li> <li><a href="#%E4%B8%89docker-compose">三、Docker Compose</a> <ul><li><a href="#docker-compose-%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85">docker-compose 命令安装</a> <ul><li><a href="#1-%E5%AE%89%E8%A3%85-python-pip">1. 安装 python-pip</a></li> <li><a href="#2-%E5%AE%89%E8%A3%85-docker-compose">2. 安装 Docker-Compose</a></li></ul></li> <li><a href="#docker-composeyml-%E8%A7%84%E8%8C%83">docker-compose.yml 规范</a></li></ul></li> <li><a href="#%E5%9B%9Bdocker-%E5%AE%9E%E6%88%98">四、Docker 实战</a> <ul><li><a href="#%E5%AE%9E%E6%88%981%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA-mysql">实战1：快速搭建 MySQL</a></li> <li><a href="#%E5%AE%9E%E6%88%982%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA-phpmyadmin">实战2：快速搭建 phpMyAdmin</a></li> <li><a href="#%E5%AE%9E%E6%88%983%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA-gitlab">实战3：快速搭建 GitLab</a></li></ul></li> <li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li></ul> <h1 id="一、docker-快速入门"><a href="#一、docker-快速入门" aria-hidden="true" class="header-anchor">#</a> 一、Docker 快速入门</h1> <p>本文部分内容引用来自：【千锋-李卫民老师博客，推荐大家学习】http://www.funtl.com/</p> <p>A simple, interactive and fun playground to learn Docker：<a href="https://labs.play-with-docker.com/" target="_blank" rel="noopener noreferrer">Play with Docker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="初探-docker"><a href="#初探-docker" aria-hidden="true" class="header-anchor">#</a> 初探 Docker</h2> <h3 id="什么是-docker"><a href="#什么是-docker" aria-hidden="true" class="header-anchor">#</a> 什么是 Docker</h3> <p>Docker 最初是 dotCloud 公司创始人 Solomon Hykes 在法国期间发起的一个公司内部项目，它是基于 dotCloud 公司多年云服务技术的一次革新，并于 <a href="https://en.wikipedia.org/wiki/Docker_(software)" target="_blank" rel="noopener noreferrer">2013 年 3 月以 Apache 2.0 授权协议开源<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，主要项目代码在 <a href="https://github.com/moby/moby" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 上进行维护。Docker 项目后来还加入了 Linux 基金会，并成立推动 <a href="https://www.opencontainers.org/" target="_blank" rel="noopener noreferrer">开放容器联盟（OCI）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>Docker 自开源后受到广泛的关注和讨论，至今其 GitHub 项目已经超过 4 万 6 千个星标和一万多个 fork。甚至由于 Docker 项目的火爆，在 2013 年底，<a href="https://blog.docker.com/2013/10/dotcloud-is-becoming-docker-inc/" target="_blank" rel="noopener noreferrer">dotCloud 公司决定改名为 Docker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。Docker 最初是在 Ubuntu 12.04 上开发实现的；Red Hat 则从 RHEL 6.5 开始对 Docker 进行支持；Google 也在其 PaaS 产品中广泛应用 Docker。</p> <p>Docker 使用 Google 公司推出的 <a href="https://golang.org/" target="_blank" rel="noopener noreferrer">Go 语言<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 进行开发实现，基于 Linux 内核的 <a href="https://zh.wikipedia.org/wiki/Cgroups" target="_blank" rel="noopener noreferrer">cgroup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，<a href="https://en.wikipedia.org/wiki/Linux_namespaces" target="_blank" rel="noopener noreferrer">namespace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，以及 <a href="https://en.wikipedia.org/wiki/Aufs" target="_blank" rel="noopener noreferrer">AUFS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 类的 <a href="https://en.wikipedia.org/wiki/Union_mount" target="_blank" rel="noopener noreferrer">Union FS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 等技术，对进程进行封装隔离，属于 <a href="https://en.wikipedia.org/wiki/Operating-system-level_virtualization" target="_blank" rel="noopener noreferrer">操作系统层面的虚拟化技术<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。最初实现是基于 <a href="https://linuxcontainers.org/lxc/introduction/" target="_blank" rel="noopener noreferrer">LXC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，从 0.7 版本以后开始去除 LXC，转而使用自行开发的 <a href="https://github.com/docker/libcontainer" target="_blank" rel="noopener noreferrer">libcontainer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，从 1.11 开始，则进一步演进为使用 <a href="https://github.com/opencontainers/runc" target="_blank" rel="noopener noreferrer">runC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://github.com/containerd/containerd" target="_blank" rel="noopener noreferrer">containerd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>Docker 在容器的基础上，进行了进一步的封装，从文件系统、网络互联到进程隔离等等，极大的简化了容器的创建和维护。使得 Docker 技术比虚拟机技术更为轻便、快捷。</p> <p>下面的图片比较了 Docker 和传统虚拟化方式的不同之处。传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。</p> <p><img src="assets/VMs-and-Containers.jpg" alt="img"></p> <h3 id="为什么要使用-docker"><a href="#为什么要使用-docker" aria-hidden="true" class="header-anchor">#</a> 为什么要使用 Docker</h3> <p><img src="assets/docker-architecture.png" alt="Docker architecture"></p> <p>作为一种新兴的虚拟化方式，Docker 跟传统的虚拟化方式相比具有众多的优势。</p> <p><strong>更高效的利用系统资源</strong></p> <p>由于容器不需要进行硬件虚拟以及运行完整操作系统等额外开销，Docker 对系统资源的利用率更高。无论是应用执行速度、内存损耗或者文件存储速度，都要比传统虚拟机技术更高效。因此，相比虚拟机技术，一个相同配置的主机，往往可以运行更多数量的应用。</p> <p><strong>更快速的启动时间</strong></p> <p>传统的虚拟机技术启动应用服务往往需要数分钟，而 Docker 容器应用，由于直接运行于宿主内核，无需启动完整的操作系统，因此可以做到秒级、甚至毫秒级的启动时间。大大的节约了开发、测试、部署的时间。</p> <p><strong>一致的运行环境</strong></p> <p>开发过程中一个常见的问题是环境一致性问题。由于开发环境、测试环境、生产环境不一致，导致有些 bug 并未在开发过程中被发现。而 Docker 的镜像提供了除内核外完整的运行时环境，确保了应用运行环境一致性，从而不会再出现 <em>「这段代码在我机器上没问题啊」</em> 这类问题。</p> <p><strong>持续交付和部署</strong></p> <p>对开发和运维（<a href="https://zh.wikipedia.org/wiki/DevOps" target="_blank" rel="noopener noreferrer">DevOps<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）人员来说，最希望的就是一次创建或配置，可以在任意地方正常运行。</p> <p>使用 Docker 可以通过定制应用镜像来实现持续集成、持续交付、部署。开发人员可以通过 <code>Dockerfile</code> 来进行镜像构建，并结合 <a href="https://en.wikipedia.org/wiki/Continuous_integration" target="_blank" rel="noopener noreferrer">持续集成(Continuous Integration)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 系统进行集成测试，而运维人员则可以直接在生产环境中快速部署该镜像，甚至结合 <a href="https://en.wikipedia.org/wiki/Continuous_delivery" target="_blank" rel="noopener noreferrer">持续部署(Continuous Delivery/Deployment)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 系统进行自动部署。</p> <p>而且使用 <code>Dockerfile</code> 使镜像构建透明化，不仅仅开发团队可以理解应用运行环境，也方便运维团队理解应用运行所需条件，帮助更好的生产环境中部署该镜像。</p> <p><strong>更轻松的迁移</strong></p> <p>由于 Docker 确保了执行环境的一致性，使得应用的迁移更加容易。Docker 可以在很多平台上运行，无论是物理机、虚拟机、公有云、私有云，甚至是笔记本，其运行结果是一致的。因此用户可以很轻易的将在一个平台上运行的应用，迁移到另一个平台上，而不用担心运行环境的变化导致应用无法正常运行的情况。</p> <p><strong>更轻松的维护和扩展</strong></p> <p>Docker 使用的分层存储以及镜像的技术，使得应用重复部分的复用更为容易，也使得应用的维护更新更加简单，基于基础镜像进一步扩展镜像也变得非常简单。此外，Docker 团队同各个开源项目团队一起维护了一大批高质量的 <a href="https://store.docker.com/search?q=&source=verified&type=image" target="_blank" rel="noopener noreferrer">官方镜像<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，既可以直接在生产环境使用，又可以作为基础进一步定制，大大的降低了应用服务的镜像制作成本。</p> <p><strong>对比传统虚拟机总结</strong></p> <table><thead><tr><th>特性</th> <th>容器</th> <th>虚拟机</th></tr></thead> <tbody><tr><td>启动</td> <td>秒级</td> <td>分钟级</td></tr> <tr><td>硬盘使用</td> <td>一般为 <code>MB</code></td> <td>一般为 <code>GB</code></td></tr> <tr><td>性能</td> <td>接近原生</td> <td>弱于</td></tr> <tr><td>系统支持量</td> <td>单机支持上千个容器</td> <td>一般几十个</td></tr></tbody></table> <h2 id="centos-7-安装-docker"><a href="#centos-7-安装-docker" aria-hidden="true" class="header-anchor">#</a> CentOS 7 安装 Docker</h2> <ol><li>先更新 yum 软件管理器，然后再安装 Docker</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> yum -y update
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> yum <span class="token function">install</span> -y docker
</code></pre></div><p>说明：上述 <code>-y</code> 代表选择程序安装中的 yes 选项</p> <p>或是，直接安装</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum <span class="token function">install</span> docker
</code></pre></div><ol start="2"><li>验证安装，查看 Docker 版本信息</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> docker -v
Docker version 1.13.1, build 8633870/1.13.1
You have new mail <span class="token keyword">in</span> /var/spool/mail/root
</code></pre></div><ol start="3"><li>启动 / 重启 / 关闭 Docker</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> docker start
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> docker restart
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span> docker stop
</code></pre></div><p>【意外情况】service docker start 无法启动问题</p> <ul><li><p>centos 安装 docker 显示 No package docker available，原因是 yum 没有找到 docker 的包，需要 epel 第三方软件库，运行下面的命令</p> <p><code>sudo yum install epel-release</code></p></li> <li><p><a href="http://www.cnblogs.com/ECJTUACM-873284962/p/9362840.html" target="_blank" rel="noopener noreferrer">【亲测有效】Centos安装完成docker后启动docker报错docker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <ol><li><p>配置yum源</p> <p>vim /etc/yum.repos.d/docker.repo</p></li></ol> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[dockerrepo]</span>
<span class="token constant">name</span><span class="token attr-value"><span class="token punctuation">=</span>Docker Repository</span>
<span class="token constant">baseurl</span><span class="token attr-value"><span class="token punctuation">=</span>https://yum.dockerproject.org/repo/main/centos/$releasever/</span>
<span class="token constant">enabled</span><span class="token attr-value"><span class="token punctuation">=</span>1</span>
<span class="token constant">gpgcheck</span><span class="token attr-value"><span class="token punctuation">=</span>1</span>
<span class="token constant">gpgkey</span><span class="token attr-value"><span class="token punctuation">=</span>https://yum.dockerproject.org/gpg</span>
</code></pre></div><ol start="2"><li>通过yum安装</li></ol> <div class="language- extra-class"><pre class="language-text"><code>yum install docker-engine
service docker start
service docker status
</code></pre></div><ol start="3"><li>日志</li></ol> <div class="language- extra-class"><pre class="language-text"><code>vim /var/log/docker
</code></pre></div><h2 id="docker-镜像加速器"><a href="#docker-镜像加速器" aria-hidden="true" class="header-anchor">#</a> Docker 镜像加速器</h2> <ol><li><p>加速器服务</p> <p><a href="https://www.daocloud.io/mirror" target="_blank" rel="noopener noreferrer">DaoCloud 加速器，一行命令，镜像万千<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://dev.aliyun.com/search.html" target="_blank" rel="noopener noreferrer">阿里云 - 开发者平台 - 容器 hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>配置 Docker 加速器</p></li></ol> <p>以 Linux 为例</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">curl</span> -sSL https://get.daocloud.io/daotools/set_mirror.sh <span class="token operator">|</span> sh -s http://f1361db2.m.daocloud.io
</code></pre></div><p>该脚本可以将 --registry-mirror 加入到你的 Docker 配置文件 /etc/docker/daemon.json 中。适用于 Ubuntu14.04、Debian、CentOS6 、CentOS7、Fedora、Arch Linux、openSUSE Leap 42.1，其他版本可能有细微不同。更多详情请访问文档。</p> <p>删除 /etc/docker/daemon.json 中最后一个逗号，重启 Docker 服务即可</p> <h2 id="docker-常用命令"><a href="#docker-常用命令" aria-hidden="true" class="header-anchor">#</a> Docker 常用命令</h2> <p><img src="assets/docker-cmd.png" alt="docker-cmd"></p> <h3 id="_1-启动、停止、重启服务"><a href="#_1-启动、停止、重启服务" aria-hidden="true" class="header-anchor">#</a> 1. 启动、停止、重启服务</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># service docker restart</span>
Redirecting to /bin/systemctl restart docker.service
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># service docker stop</span>
Redirecting to /bin/systemctl stop docker.service
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># service docker start</span>
Redirecting to /bin/systemctl start docker.service
</code></pre></div><h3 id="_2-拉取一个镜像，启动容器"><a href="#_2-拉取一个镜像，启动容器" aria-hidden="true" class="header-anchor">#</a> 2. 拉取一个镜像，启动容器</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker pull centos</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker run -it -v /centos_dir:/docker_dir --name biodwhu-1 centos</span>
</code></pre></div><ul><li><p>-i：允许我们对容器内的 (STDIN) 进行交互</p></li> <li><p>-t：在新容器内指定一个伪终端或终端</p></li> <li><p>-v：是挂在宿机目录， /centos_dir 是宿机目录，/docker_dir 是当前 Docker 容器的目录，宿机目录必须是绝对的。</p></li> <li><p>-p：端口映射</p></li> <li><p>--name：是给容器起一个名字，可省略，省略的话 docker 会随机产生一个名字</p></li> <li><p>--restart：always</p></li></ul> <h3 id="_3-启动的容器列表"><a href="#_3-启动的容器列表" aria-hidden="true" class="header-anchor">#</a> 3. 启动的容器列表</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
</code></pre></div><h3 id="_4-查看所有的容器"><a href="#_4-查看所有的容器" aria-hidden="true" class="header-anchor">#</a> 4. 查看所有的容器</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
</code></pre></div><h3 id="_5-启动、停止、重启某个容器"><a href="#_5-启动、停止、重启某个容器" aria-hidden="true" class="header-anchor">#</a> 5. 启动、停止、重启某个容器</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker start biodwhu-1</span>
biodwhu-1
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker stop biodwhu-2</span>
biodwhu-2
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker restart biodwhu-3</span>
biodwhu-3
</code></pre></div><h3 id="_6-查看指定容器的日志记录"><a href="#_6-查看指定容器的日志记录" aria-hidden="true" class="header-anchor">#</a> 6. 查看指定容器的日志记录</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker logs -f biodwhu-1</span>
</code></pre></div><h3 id="_7-删除某个容器，若正在运行，需要先停止"><a href="#_7-删除某个容器，若正在运行，需要先停止" aria-hidden="true" class="header-anchor">#</a> 7. 删除某个容器，若正在运行，需要先停止</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rm biodwhu-1</span>
Error response from daemon: You cannot remove a running container 2d48fc5b7c17b01e6247cbc012013306faf1e54f24651d5e16d6db4e15f92d33. Stop the container before attempting removal or use -f
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker stop biodwhu-1</span>
biodwhu-1
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rm biodwhu-1</span>
biodwhu-1
</code></pre></div><h3 id="_8-删除容器"><a href="#_8-删除容器" aria-hidden="true" class="header-anchor">#</a> 8. 删除容器</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 删除某个容器</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rm f3b346204a39</span>

<span class="token comment"># 删除所有容器</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker stop $(docker ps -a -q)</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rm $(docker ps -a -q)</span>
</code></pre></div><h3 id="_9-删除镜像"><a href="#_9-删除镜像" aria-hidden="true" class="header-anchor">#</a> 9. 删除镜像</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 删除某个镜像</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rmi docker.io/mysql:5.6</span>

<span class="token comment"># 删除所有镜像</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rmi $(docker images -q)</span>

<span class="token comment"># 强制删除所有镜像</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rmi -f $(docker images -q)</span>
</code></pre></div><h3 id="_10-删除虚悬镜像"><a href="#_10-删除虚悬镜像" aria-hidden="true" class="header-anchor">#</a> 10. 删除虚悬镜像</h3> <p>我们在 build 镜像的过程中，可能会产生一些临时的不具有名称也没有作用的镜像他们的名称一般都是 <code>&lt;none&gt;</code> ,我们可以执行下面的命令将其清除掉：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker rmi $(docker images -f &quot;dangling=true&quot; -q)</span>
<span class="token comment"># 或者</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker image prune -a -f</span>
</code></pre></div><h3 id="_11-镜像导入与导出"><a href="#_11-镜像导入与导出" aria-hidden="true" class="header-anchor">#</a> 11. 镜像导入与导出</h3> <p>保存镜像</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker save a46c2a2722b9 &gt; /var/docker/images_save/mysql.tar.gz</span>
</code></pre></div><p>加载镜像</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker load -i /var/docker/images_save/mysql.tar.gz</span>
</code></pre></div><h1 id="二、docker-file-镜像构建"><a href="#二、docker-file-镜像构建" aria-hidden="true" class="header-anchor">#</a> 二、Docker File 镜像构建</h1> <h1 id="三、docker-compose"><a href="#三、docker-compose" aria-hidden="true" class="header-anchor">#</a> 三、Docker Compose</h1> <h2 id="docker-compose-命令安装"><a href="#docker-compose-命令安装" aria-hidden="true" class="header-anchor">#</a> docker-compose 命令安装</h2> <p>Docker-Compose 是一个部署多个容器的简单但是非常必要的工具.</p> <p>安装 Docker-Compose 之前，请先安装 python-pip</p> <h3 id="_1-安装-python-pip"><a href="#_1-安装-python-pip" aria-hidden="true" class="header-anchor">#</a> 1. 安装 python-pip</h3> <ol><li>首先检查 Linux 有没有安装 python-pip 包，终端执行 pip -v</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip -V</span>
-bash: pip: <span class="token function">command</span> not found
</code></pre></div><ol start="2"><li>没有 python-pip 包就执行命令</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># yum -y install epel-release</span>
</code></pre></div><ol start="3"><li>执行成功之后，再次执行</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># yum -y install python-pip</span>
</code></pre></div><ol start="4"><li>对安装好的 pip 进行升级</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install --upgrade pip</span>
</code></pre></div><h3 id="_2-安装-docker-compose"><a href="#_2-安装-docker-compose" aria-hidden="true" class="header-anchor">#</a> 2. 安装 Docker-Compose</h3> <ol><li>终端执行</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install docker-compose</span>
</code></pre></div><ol start="2"><li>检查 docker-compose 安装</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker-compose -version</span>
</code></pre></div><p>参考资料：</p> <ul><li><a href="https://www.cnblogs.com/YatHo/p/7815400.html" target="_blank" rel="noopener noreferrer">CentOS7下安装Docker-Compose - YatHo - 博客园<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="docker-compose-yml-规范"><a href="#docker-compose-yml-规范" aria-hidden="true" class="header-anchor">#</a> docker-compose.yml 规范</h2> <h1 id="四、docker-实战"><a href="#四、docker-实战" aria-hidden="true" class="header-anchor">#</a> 四、Docker 实战</h1> <h2 id="实战1：快速搭建-mysql"><a href="#实战1：快速搭建-mysql" aria-hidden="true" class="header-anchor">#</a> 实战1：快速搭建 MySQL</h2> <ul><li><p>官方镜像仓库</p> <p><a href="https://hub.docker.com/_/mysql/" target="_blank" rel="noopener noreferrer">https://hub.docker.com/_/mysql/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>docker-compose.yml</p></li></ul> <div class="language-yml extra-class"><pre class="language-text"><code>version: '3.1'
services:
  mysql:
    restart: always
    image: mysql:5.6
    container_name: mysql
    ports:
      - 3306:3306
    environment:
      TZ: Asia/Shanghai
      MYSQL_ROOT_PASSWORD: 123456
    command:
      --character-set-server=utf8mb4
      --collation-server=utf8mb4_general_ci
      --explicit_defaults_for_timestamp=true
      --lower_case_table_names=1
      --max_allowed_packet=128M
      --sql-mode=&quot;STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO&quot;
    volumes:
      - /usr/local/docker/mysql/mysql-data:/var/lib/mysql
</code></pre></div><h2 id="实战2：快速搭建-phpmyadmin"><a href="#实战2：快速搭建-phpmyadmin" aria-hidden="true" class="header-anchor">#</a> 实战2：快速搭建 phpMyAdmin</h2> <ul><li><p>官方镜像仓库</p> <p><a href="phpmyadmin/phpmyadmin">phpmyadmin/phpmyadmin</a></p></li> <li><p>docker-compose.yml</p></li></ul> <div class="language-yml extra-class"><pre class="language-text"><code>version: '3.1'
services:
  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: phpmyadmin
    environment:
     - PMA_ARBITRARY=1
     - PMA_HOST=120.92.17.12
    # - PMA_PORT=3306
    # - PMA_USER=xxx
    # - PMA_PASSWORD=xxx
    restart: always
    ports:
     - 6060:80
    volumes:
     - /sessions
</code></pre></div><h2 id="实战3：快速搭建-gitlab"><a href="#实战3：快速搭建-gitlab" aria-hidden="true" class="header-anchor">#</a> 实战3：快速搭建 GitLab</h2> <p>GitLab 使用163邮箱发送邮件 - 刘锐群的笔记 - CSDN博客
https://blog.csdn.net/liuruiqun/article/details/50000213</p> <p>gitlab服务器邮箱配置 - weifengCorp - 博客园
https://www.cnblogs.com/weifeng1463/p/8489563.html</p> <p>twang2218/gitlab-ce-zh - Docker Hub
https://hub.docker.com/r/twang2218/gitlab-ce-zh/</p> <div class="language-yml extra-class"><pre class="language-text"><code>version: '3'
services:
    web:
      image: 'twang2218/gitlab-ce-zh:10.5'
      restart: always
      hostname: '120.131.11.187'
      environment:
        TZ: 'Asia/Shanghai'
        GITLAB_OMNIBUS_CONFIG: |
          external_url 'http://120.131.11.187:3000'
          gitlab_rails['gitlab_shell_ssh_port'] = 2222
          unicorn['port'] = 8888
          nginx['listen_port'] = 3000
      ports:
        - '3000:3000'
        - '8443:443'
        - '2222:22'
      volumes:
        - /usr/local/docker/gitlab/config:/etc/gitlab
        - /usr/local/docker/gitlab/data:/var/opt/gitlab
        - /usr/local/docker/gitlab/logs:/var/log/gitlab
</code></pre></div><h1 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h1> <ul><li><a href="https://my-fe.pub/post/docker-front-and-backend-separation.html#toc-619" target="_blank" rel="noopener noreferrer">docker前后分离笔记 - 小翼的前端天地<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/frank-lam/fullstack-tutorial/edit/master/docs/notes/Docker基础.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/20/2018, 12:56:39 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/fullstack-tutorial-site/assets/js/app.e23029aa.js" defer></script><script src="/fullstack-tutorial-site/assets/js/17.f0e20aa7.js" defer></script>
  </body>
</html>
