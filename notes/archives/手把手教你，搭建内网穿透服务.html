<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>手把手教你，搭建内网穿透服务 | Full Stack Developer Tutorial</title>
    <meta name="description" content="from zero to hero">
    <link rel="icon" href="/fullstack-tutorial-site/favicon.ico">
    
    <link rel="preload" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css" as="style"><link rel="preload" href="/fullstack-tutorial-site/assets/js/app.e23029aa.js" as="script"><link rel="preload" href="/fullstack-tutorial-site/assets/js/40.ffb34422.js" as="script"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/10.styles.e7bfa7b0.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/7.styles.a8031ade.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/1.82e55b14.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/10.e7bfa7b0.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/11.42acfd5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/12.f0884d8e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/13.c57f5837.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/14.07fd252d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/15.9dcc583e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/16.42bd51ad.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/17.f0e20aa7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/18.62b756df.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/19.732a8ec2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/2.57da3069.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/20.1cd96f80.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/21.e3ef896c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/22.8dd77b6a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/23.5ae08c37.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/24.5a34ccb1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/25.7dee6df6.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/26.af9b2812.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/27.6f5b260d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/28.c5f782da.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/29.799a3dea.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/3.4193afeb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/30.8bb33866.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/31.a2bf48a5.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/32.2dd32760.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/33.8b1034f7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/34.8e3964bc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/35.57d9f500.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/36.49aead0e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/37.60183b23.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/38.3416c1ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/39.cc8bcef9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/4.020e03fa.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/41.feec12a7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/42.4e1803cc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/43.6a56bbfb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/44.ef11fafe.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/45.6b3189d2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/46.cf48bc8c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/47.bbcdd89a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/48.9ad3fe5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/49.c4eb64f9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/5.f4777b53.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/50.79d979ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/51.bee6678b.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/52.5e069c45.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/53.b4ed7749.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/54.37b05d6c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/55.9497455f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/56.7459f398.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/57.a21a8691.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/58.5c0b7c68.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/59.083c760f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/6.0c32f6b7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/60.881f6ac9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/61.ebc72343.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/62.3514484e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/63.39076018.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/64.20372ac4.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/65.cc25487c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/66.e130b690.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/67.40d544ec.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/68.371c66ba.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/69.bf625d87.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/7.a8031ade.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/70.53616ef1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/71.1e855d2c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/72.ebb7d332.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/73.7b72b76a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/74.7f93f494.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/8.27947311.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/9.ca56268b.js">
    <link rel="stylesheet" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fullstack-tutorial-site/" class="home-link router-link-active"><!----> <span class="site-name">Full Stack Developer Tutorial</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">全栈指南</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link router-link-active">场景实战</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">捐赠</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">作者</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择/语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/archives/手把手教你，搭建内网穿透服务.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">全栈指南</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link router-link-active">场景实战</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">捐赠</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">作者</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择/语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/archives/手把手教你，搭建内网穿透服务.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><div id="codefund_ad"></div></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Get Start</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/" class="sidebar-link">快速开始</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Java 技术栈</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/01 Java 基础.html" class="sidebar-link">Java 基础概念</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java 集合框架.html" class="sidebar-link">Java 集合框架</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/03 Java 并发编程.html" class="sidebar-link">Java 并发编程</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/04 Java IO.html" class="sidebar-link">Java I/O</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/05 Java 虚拟机.html" class="sidebar-link">Java 虚拟机</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/07 Java Web.html" class="sidebar-link">Java Web</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>数据库</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/MySQL.html" class="sidebar-link">前言</a></li><li><a href="/fullstack-tutorial-site/notes/SQL.html" class="sidebar-link">前言</a></li><li><a href="/fullstack-tutorial-site/notes/Redis.html" class="sidebar-link">前言</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><ul><li><a href="#%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%9C%8D%E5%8A%A1">手把手教你，搭建内网穿透服务</a> <ul><li><a href="#%E4%B8%80%E6%A6%82%E8%BF%B0">一、概述</a> <ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AF%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F">1.1 什么是内网穿透</a></li> <li><a href="#12-%E4%BB%80%E4%B9%88%E6%98%AF-lanproxy">1.2 什么是 lanproxy</a></li> <li><a href="#13-%E5%8E%9F%E7%90%86">1.3 原理</a></li></ul></li> <li><a href="#%E4%BA%8C%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B">二、快速开始</a> <ul><li><a href="#21-%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82">2.1 硬件与环境要求</a></li> <li><a href="#22-%E5%85%AC%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEdocker-%E4%B8%80%E9%94%AE%E5%90%AF%E5%8A%A8">2.2 公网服务器配置（Docker 一键启动）</a> <ul><li><a href="#%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85">基础环境安装</a></li> <li><a href="#%E9%80%9A%E8%BF%87-docker%E5%90%AF%E5%8A%A8-lanproxy-%E6%9C%8D%E5%8A%A1">通过 Docker，启动 lanproxy 服务</a></li> <li><a href="#nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D">Nginx 反向代理配置域名</a></li> <li><a href="#%E7%BB%A7%E7%BB%AD%E9%85%8D%E7%BD%AE-lanproxy-%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1">继续配置 lanproxy 后台服务</a></li></ul></li> <li><a href="#23-%E5%86%85%E7%BD%91%E7%94%B5%E8%84%91%E9%85%8D%E7%BD%AEjava-%E5%AE%A2%E6%88%B7%E7%AB%AF">2.3 内网电脑配置（Java 客户端）</a> <ul><li><a href="#java-18-%E5%AE%89%E8%A3%85">Java 1.8 安装</a></li> <li><a href="#maven-%E5%AE%89%E8%A3%85">maven 安装</a></li> <li><a href="#%E5%90%AF%E5%8A%A8%E5%86%85%E7%BD%91%E6%9C%8D%E5%8A%A1">启动内网服务</a></li> <li><a href="#%E8%BF%90%E8%A1%8C-lanproxy-client-%E6%9C%8D%E5%8A%A1">运行 lanproxy client 服务</a></li> <li><a href="#lanproxy-%E7%BD%91%E9%A1%B5%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1">lanproxy 网页后台服务</a></li></ul></li> <li><a href="#24-%E5%86%85%E7%BD%91%E7%94%B5%E8%84%91%E9%85%8D%E7%BD%AEgo-%E5%AE%A2%E6%88%B7%E7%AB%AF">2.4 内网电脑配置（GO 客户端）</a> <ul><li><a href="#%E5%AE%89%E8%A3%85go%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85">安装Go环境安装</a></li> <li><a href="#%E6%8B%89%E5%8F%96-ffaylanproxy-go-client-%E4%BB%A3%E7%A0%81">拉取 ffay/lanproxy-go-client 代码</a></li> <li><a href="#%E5%AE%89%E8%A3%85%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BE%9D%E8%B5%96%E5%8C%85">安装客户端依赖包</a></li> <li><a href="#%E5%90%AF%E5%8A%A8%E5%AE%A2%E6%88%B7%E7%AB%AF">启动客户端</a></li></ul></li></ul></li> <li><a href="#%E4%B8%89%E6%80%BB%E7%BB%93">三、总结</a></li> <li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li></ul></li></ul> <h1 id="手把手教你，搭建内网穿透服务"><a href="#手把手教你，搭建内网穿透服务" aria-hidden="true" class="header-anchor">#</a> 手把手教你，搭建内网穿透服务</h1> <p>在很多场景下内网穿透都是我们常常遇到的需求，之前也用过花生壳、ngrok、FRP 等等一些工具，但是由于限速、收费、安全各方面因素只好放弃了。</p> <p>目前所在实验室主要从事深度学习和机器学习相关工作，有一台高配 GPU 计算型服务器，大家使用 Jupyter Notebook 在网页上进行编码工作，但是只能在学院内网才能进行使用，在外面就无法使用让人比较抓狂。如果购买阿里云等深度学习服务，价格昂贵，只好决定通过内网穿透实现公网工作。</p> <p>近期无意间看到 <a href="https://github.com/ffay/lanproxy" target="_blank" rel="noopener noreferrer">「传送门：lanproxy」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这款开源工具，正好实验室购置了一台公网服务器，正好可以实现内网穿透，决定入坑折腾一番。对于有后台开发基础的同学还是挺简单的，不过好记性不如烂笔头，来吧，这里手把手深入探索一番。</p> <h2 id="一、概述"><a href="#一、概述" aria-hidden="true" class="header-anchor">#</a> 一、概述</h2> <h3 id="_1-1-什么是内网穿透"><a href="#_1-1-什么是内网穿透" aria-hidden="true" class="header-anchor">#</a> 1.1 什么是内网穿透</h3> <p>好吧，先上一段百度百科的定义</p> <blockquote><p>内网穿透，即NAT穿透，网络连接时术语，计算机是局域网内时，外网与内网的计算机节点需要连接通信，有时就会出现不支持内网穿透。</p></blockquote> <p>反正简单来说，就是能通过公网访问你的内网服务，把你的内网通过一台公网服务器，穿透出去。</p> <h3 id="_1-2-什么是-lanproxy"><a href="#_1-2-什么是-lanproxy" aria-hidden="true" class="header-anchor">#</a> 1.2 什么是 lanproxy</h3> <p>lanproxy 是一个将局域网个人电脑、服务器代理到公网的内网穿透工具，目前仅支持 tcp 流量转发，可支持任何 tcp 上层协议（访问内网网站、本地支付接口调试、ssh 访问、远程桌面...）。目前市面上提供类似服务的有花生壳、TeamView、GoToMyCloud 等等，但要使用第三方的公网服务器就必须为第三方付费，并且这些服务都有各种各样的限制，此外，由于数据包会流经第三方，因此对数据安全也是一大隐患。<a href="https://lanproxy.io2c.com/" target="_blank" rel="noopener noreferrer">https://lanproxy.io2c.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_1-3-原理"><a href="#_1-3-原理" aria-hidden="true" class="header-anchor">#</a> 1.3 原理</h3> <p>内网穿透的原理如下图所示：</p> <ol><li><p>用户访问我们的服务器，这个服务器是有公网IP的，所以用户可以无压力访问</p></li> <li><p>服务器与本地电脑保持长链接，当有请求的时候，服务器将请求转发到我们的本地电脑</p></li> <li><p>本地电脑将响应回复给服务器</p></li> <li><p>服务器将响应回复给用户</p> <div align="center"><img src="assets/15229416333639.jpg" width="300"></div></li></ol> <p>要搭建内网穿透，我们得完成两个任务</p> <ol><li>在公网能访问的服务器上运行我们的内网穿透服务；</li> <li>在本地电脑上面运行内网穿透客户端。</li></ol> <p>当然，你可以自己根据原理实现一套，不过我们有现成的三方开源工具，可以帮我们实现这一套功能。这个就是我们今天的主角 <a href="https://github.com/ffay/lanproxy" target="_blank" rel="noopener noreferrer">lanproxy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="二、快速开始"><a href="#二、快速开始" aria-hidden="true" class="header-anchor">#</a> 二、快速开始</h2> <blockquote><p>这里我将手把手带你配置 lanproxy 穿透服务，这里配置主要分成了 <strong>公网服务器配置</strong> 和 <strong>内网电脑配置</strong> 。</p> <p>在内网电脑配置中分为：Java 客户端和 GO 客户端</p></blockquote> <h3 id="_2-1-硬件与环境要求"><a href="#_2-1-硬件与环境要求" aria-hidden="true" class="header-anchor">#</a> 2.1 硬件与环境要求</h3> <blockquote><p>这里以我的环境为例</p></blockquote> <ol><li><strong>一台公网服务器</strong>（Centos 7.4，当然这不重要，反正都 docker 啦）
<ul><li>docker（简化更多的配置，这里采用 docker 容器进行搭建）</li> <li>Nginx 环境</li></ul></li> <li><strong>一台内网电脑</strong>（Ubuntu 16.04）
<ul><li>Java JDK 1.8</li> <li>Maven（包依赖管理工具）</li> <li>docker 启动服务，tensorflow（jupyter notebook）</li></ul></li> <li><strong>已备案的域名</strong> <ul><li>此步骤也可省略，但端口太多通过 Nginx 配合域名进行转发，使用更加方便。故这里我也将会配置两个公网域名</li></ul></li></ol> <h3 id="_2-2-公网服务器配置（docker-一键启动）"><a href="#_2-2-公网服务器配置（docker-一键启动）" aria-hidden="true" class="header-anchor">#</a> 2.2 公网服务器配置（Docker 一键启动）</h3> <h4 id="基础环境安装"><a href="#基础环境安装" aria-hidden="true" class="header-anchor">#</a> 基础环境安装</h4> <ol><li>安装 docker 服务，以 CentOS 7.4 为例</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>1、安装依赖包
$ <span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils  device-mapper-persistent-data  lvm2

2、设置稳定版仓库
$ <span class="token function">sudo</span> yum-config-manager   --add-repo  https://download.docker.com/linux/centos/docker-ce.repo

3、安装
//安装最新版本
$ <span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce

//或者安装指定版本
$ yum list docker-ce --showduplicates <span class="token operator">|</span> <span class="token function">sort</span> -r
    //显示有以下版本
    docker-ce.x86_64            18.03.0.ce-1.el7.centos             docker-ce-stable
//指定一个版本进行安装
$ <span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce-<span class="token operator">&lt;</span>VERSION STRING<span class="token operator">&gt;</span>

4、启动doker
$ <span class="token function">sudo</span> systemctl start docker

5、通过运行hello-world镜像验证安装是否成功
$ <span class="token function">sudo</span> docker run hello-world
</code></pre></div><ol start="2"><li>安装 Nginx 服务，以 CentOS 7.4 为例</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>1.添加Nginx到YUM源
$ <span class="token function">sudo</span> rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm

2.安装Nginx
$ <span class="token function">sudo</span> yum <span class="token function">install</span> -y nginx
Nginx将完成安装在你的CentOS 7 服务器中。

3.启动Nginx
$ <span class="token function">service</span> nginx start
</code></pre></div><ul><li>更多配置请参考：<a href="https://blog.csdn.net/u012486840/article/details/52610320" target="_blank" rel="noopener noreferrer">CentOS 7 yum 安装 Nginx - 菜鸟路上的小白 - CSDN博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="通过-docker，启动-lanproxy-服务"><a href="#通过-docker，启动-lanproxy-服务" aria-hidden="true" class="header-anchor">#</a> 通过 Docker，启动 lanproxy 服务</h4> <p>启动 Docker 后运行一下代码</p> <div class="language- extra-class"><pre class="language-text"><code>docker run -d \
           --name lanproxy-server \
           -p 8090:8090 \
           -p 4900:4900 \
           -p 4993:4993 \
           -p 9000-9100:9000-9100 \
           biodwhu/lanproxy
</code></pre></div><p>输入你的公网服务器 IP:8090，例如：http://120.92.10.120:8090/，即可看到如下的界面。好啦，到这里 lanproxy 的基础环境已经搭建成功，是不是很快，这就是 docker 的魅力。如果不用 docker 启动，请参考 lanproxy 的官方文档。</p> <p><img src="assets/1544794304011.png" alt="1544794304011"></p> <p>默认：account/password：admin/admin</p> <h4 id="nginx-反向代理配置域名"><a href="#nginx-反向代理配置域名" aria-hidden="true" class="header-anchor">#</a> Nginx 反向代理配置域名</h4> <p>在上一步，我们通过 docker 启动了一个 lanproxy 环境，但是通过 IP 和端口号组合的方式并不优雅。这里我将解析两个域名通过 Nginx 进行端口转发。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 两个域名都解析到你的公网上去</span>

<span class="token comment"># 这个域名由于访问 lanproxy 管理后台</span>
lanproxy.frankfeekr.cn  <span class="token operator">=</span><span class="token operator">&gt;</span> 120.92.10.120  <span class="token operator">|</span> Nginx to <span class="token operator">=</span><span class="token operator">&gt;</span> 127.0.0.1:8090

<span class="token comment"># 这个域名由于访问你的内网电脑服务，9000 端口可自由的在 lanproxy 管理后台进行配置</span>
jupyter.frankfeekr.cn   <span class="token operator">=</span><span class="token operator">&gt;</span> 120.92.10.120  <span class="token operator">|</span> Nginx to <span class="token operator">=</span><span class="token operator">&gt;</span> 127.0.0.1:9000
</code></pre></div><p>好啦，上门就是对域名进行了一些简单的解释，现在开始 Nginx 的配置</p> <ol><li><p>进入 <code>/etc/nginx/conf.d</code> Nginx 的配置目录，在这里创建配置文件</p></li> <li><p>创建 <code>lanproxy.frankfeekr.cn.conf</code> 配置文件</p></li></ol> <div class="language-yml extra-class"><pre class="language-text"><code>server {
    listen 80;
    # 这里使用自己的域名
    server_name lanproxy.frankfeekr.cn;
    charset utf-8;
    location / {
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   Host      $http_host;
        # 这里根据你的 lanproxy 配置，改成 config.server.port的值
        proxy_pass       http://127.0.0.1:8090;
        client_max_body_size 35m;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;upgrade&quot;;
    }
}
</code></pre></div><ol start="3"><li>创建  <code>jupyter.frankfeekr.cn.conf</code> 配置文件</li></ol> <div class="language-yml extra-class"><pre class="language-text"><code>server {
    listen 80;
    # 这里使用自己的域名
    server_name jupyter.frankfeekr.cn;
    charset utf-8;
    location / {
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   Host      $http_host;
        # 这里根据你的lanproxy配置，改成 外网接口 的值，在lanproxy后台网页上配置，后面配置
        proxy_pass       http://127.0.0.1:9000;
        client_max_body_size 35m;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;upgrade&quot;;
    }
}
</code></pre></div><ol start="4"><li>重启 Nginx 服务</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">service</span> nginx restart
</code></pre></div><p>至此，你可以通过域名 http://lanproxy.frankfeekr.cn 进行访问 lanproxy 网页后台配置</p> <h4 id="继续配置-lanproxy-后台服务"><a href="#继续配置-lanproxy-后台服务" aria-hidden="true" class="header-anchor">#</a> 继续配置 lanproxy 后台服务</h4> <ol><li>添加一个客户端</li></ol> <p><img src="assets/1544795186699.png" alt="1544795186699"></p> <ol start="2"><li>添加配置</li></ol> <p><img src="assets/1544795764181.png" alt="1544795764181"></p> <p>至此，服务端的配置就完成了。下面开始内网电脑的配置。</p> <h3 id="_2-3-内网电脑配置（java-客户端）"><a href="#_2-3-内网电脑配置（java-客户端）" aria-hidden="true" class="header-anchor">#</a> 2.3 内网电脑配置（Java 客户端）</h3> <blockquote><p>这里我的内网是一台 Ubuntu 16.04 的服务器，以下我都将以此为例</p></blockquote> <h4 id="java-1-8-安装"><a href="#java-1-8-安装" aria-hidden="true" class="header-anchor">#</a> Java 1.8 安装</h4> <ol><li>下载 JDK1.8（lanproxy 支持 JDK1.7 以上环境）</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">wget</span> https://download.oracle.com/otn-pub/java/jdk/8u191-b12/2787e4a523244c269598db4e85c51e0c/jdk-8u191-linux-x64.tar.gz
</code></pre></div><ol><li>解压安装包，移动文件夹到 /user/lib 目录</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">tar</span> -zxvf jdk-8u191-linux-x64.tar.gz
$ <span class="token function">mv</span> jdk1.8.0_191 /usr/lib/jdk/jdk1.8.0_191
</code></pre></div><ol><li><p>环境变量配置</p> <p>这里是将环境变量配置在 etc/profile，即为所有用户配置 JDK 环境。</p></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ vim + etc/profile
</code></pre></div><p>​	环境设置</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#set java env</span>
<span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/usr/lib/jdk/jdk1.8.0_191
<span class="token function">export</span> JRE_HOME<span class="token operator">=</span><span class="token variable">${JAVA_HOME}</span>/jre    
<span class="token function">export</span> CLASSPATH<span class="token operator">=</span>.:<span class="token variable">${JAVA_HOME}</span>/lib:<span class="token variable">${JRE_HOME}</span>/lib    
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">${JAVA_HOME}</span>/bin:<span class="token variable">$PATH</span>
</code></pre></div><p>​	执行命令使修改立即生效</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">source</span> /etc/profile
</code></pre></div><ol><li><p>配置软连接</p> <p>软连接相当于windows系统中的快捷键，部分软件可能会从/usr/bin目录下查找Java，因此添加该软连接防止其他软件查找不到的情况。</p></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> update-alternatives --install /usr/bin/java  java  /usr/lib/jdk/jdk1.8.0_191/java 300   
$ <span class="token function">sudo</span> update-alternatives --install /usr/bin/javac  javac  /usr/lib/jdk/jdk1.8.0_191/bin/javac 300 
</code></pre></div><ol><li>测试安装是否成功</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 在终端输入，出现版本号则表示安装成功</span>
$ java -version
</code></pre></div><p>更详细文档：</p> <ul><li><a href="https://blog.csdn.net/smile_from_2015/article/details/80056297" target="_blank" rel="noopener noreferrer">ubuntu16.04搭建jdk1.8运行环境 - 朝花夕拾 - CSDN博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="maven-安装"><a href="#maven-安装" aria-hidden="true" class="header-anchor">#</a> maven 安装</h4> <p>maven 是个项目管理工具，在编程领域应用广泛。</p> <ol><li><a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 下载maven。</li></ol> <p><img src="assets/20170724230855998.png" alt="img"></p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">wget</span> https://www-eu.apache.org/dist/maven/maven-3/3.6.0/binaries/apache-maven-3.6.0-bin.tar.gz
</code></pre></div><ol start="2"><li>解压到 /opt/maven 目录</li></ol> <p>创建 manve 目录。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> <span class="token function">mkdir</span> /opt/maven
</code></pre></div><p>解压到 /opt/maven 目录下。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> <span class="token function">tar</span> zxvf apache-maven-3.6.0-bin.tar.gz -C /opt/maven
</code></pre></div><ol start="3"><li>配置 maven 环境</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ vim + /etc/profile
</code></pre></div><p>在文件内容后面添加以下内容：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># set maven env</span>
<span class="token function">export</span> M2_HOME<span class="token operator">=</span>/opt/maven/apache-maven-3.6.0
<span class="token function">export</span> CLASSPATH<span class="token operator">=</span><span class="token variable">$CLASSPATH</span><span class="token keyword">:</span><span class="token variable">$M2_HOME</span>/lib
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$M2_HOME</span>/bin
</code></pre></div><p>保存，输入以下命令使配置文件生效。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">source</span> /etc/profile
</code></pre></div><p>验证是否安装成功。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ mvn -v
</code></pre></div><ol start="4"><li>修改 maven 源为阿里云，以及仓库默认存放路径。这样 maven 下载 jar 包的速度会快很多。</li></ol> <p>打开 maven 的配置文件</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ vim /opt/maven/apache-maven-3.6.0/conf/settings.xml
</code></pre></div><p>在 /home 目录下生成 maven/repository 文件夹</p> <p><img src="assets/1544797073237.png" alt="1544797073237"></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localRepository</span><span class="token punctuation">&gt;</span></span>maven/reposity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localRepository</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>修改源</p> <p><img src="assets/1544797106999.png" alt="1544797106999"></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>alimaven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>aliyun maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.aliyun.com/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>        
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>至此，Maven 安装成功</p> <p>参考资料：</p> <ul><li><a href="https://blog.csdn.net/qq_24091555/article/details/76039475" target="_blank" rel="noopener noreferrer">ubuntu16.04安装maven - Rocky的编程随记 - CSDN博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="启动内网服务"><a href="#启动内网服务" aria-hidden="true" class="header-anchor">#</a> 启动内网服务</h4> <p>在前面我们将 jupyter.frankfeekr.cn 反向代理（公网服务器 9000 服务，内网 5050）</p> <p><img src="assets/1544797593907.png" alt="1544797593907"></p> <p>这里我们需要确保在内网电脑上，浏览器能够访问到 127.0.0.1:5050 这个服务。以我的 jupyter notebook 为例：</p> <p><img src="assets/1544797708925.png" alt="1544797708925"></p> <p>这里，我的内网服务已经启动。接下来只需要启动 lanproxy 客户端即可。</p> <h4 id="运行-lanproxy-client-服务"><a href="#运行-lanproxy-client-服务" aria-hidden="true" class="header-anchor">#</a> 运行 lanproxy client 服务</h4> <p>官方提供了两种方式运行客户端，一种方式是使用官方提供的 GO，另一种通过 Java 环境运行。本文采用主流的 Java 方式运行</p> <ol><li>克隆 <code>lanproxy</code> 代码到本地电脑</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">git</span> clone https://github.com/ffay/lanproxy.git lanproxy
</code></pre></div><ol start="2"><li>打包 <code>lanproxy</code>
打包之前需要确保你安装了 <code>maven</code></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">cd</span> lanproxy
$ mvn package
</code></pre></div><ol start="3"><li>修改配置文件信息
打包完成之后，客户端文件会出现在 <code>distribution/proxy-client-0.1</code> 目录下，打开之后有是个文件夹：<code>bin</code>、<code>conf</code>、<code>lib</code>和<code>log</code>，配置信息在 <code>conf/config.properties</code> 文件内，根据前面服务端的配置信息修改一下。</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 这里是在lanproxy后台配置的密钥</span>
client.key<span class="token operator">=</span>e6a49a19b8024652ab4ff2210abf2c6a

<span class="token comment"># 配置ssl信息，根据服务端的配置填写（enable = false 就不需要配置）</span>
ssl.enable<span class="token operator">=</span>false
ssl.jksPath<span class="token operator">=</span>test.jks
ssl.keyStorePassword<span class="token operator">=</span>123456

<span class="token comment"># 服务器的ip</span>
server.host<span class="token operator">=</span>120.92.10.120

<span class="token comment">#proxy-server ssl默认端口4993，默认普通端口4900</span>
<span class="token comment">#ssl.enable=true时这里填写ssl端口，ssl.enable=false时这里填写普通端口</span>
server.port<span class="token operator">=</span>4900
</code></pre></div><ol start="4"><li>启动客户端
客户端信息配置完成之后就可以启动客户端了</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># mac/linux使用这个</span>
$ <span class="token function">bash</span>  bin/startup.sh

<span class="token comment"># Windows 直接运行 bin/startup.bat</span>
</code></pre></div><ol start="5"><li><p>访问测试</p> <p>至此，即可通过公网域名 http://jupyter.frankfeekr.cn 访问内网服务，实现内网穿透</p></li></ol> <p><img src="assets/1544798196919.png" alt="1544798196919"></p> <p>当然你也可以通过公网 IP 和域名访问，例如：http://120.92.10.120:9000 这种方式访问！</p> <ol start="6"><li>停止客户端</li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">bash</span>  bin/stop.sh
</code></pre></div><h4 id="lanproxy-网页后台服务"><a href="#lanproxy-网页后台服务" aria-hidden="true" class="header-anchor">#</a> lanproxy 网页后台服务</h4> <p>客户端启动服务后，后台可查看状态（在线 / 离线）</p> <p><img src="assets/1544798600592.png" alt="1544798600592"></p> <p>流量统计</p> <p><img src="assets/1544798624799.png" alt="1544798624799"></p> <h3 id="_2-4-内网电脑配置（go-客户端）"><a href="#_2-4-内网电脑配置（go-客户端）" aria-hidden="true" class="header-anchor">#</a> 2.4 内网电脑配置（GO 客户端）</h3> <p>GitHub 客户端主页：<a href="https://github.com/ffay/lanproxy-go-client" target="_blank" rel="noopener noreferrer">lanproxy-go-client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>不想安装 Java 环境的可以选择 Go</p> <h4 id="安装go环境安装"><a href="#安装go环境安装" aria-hidden="true" class="header-anchor">#</a> 安装Go环境安装</h4> <p><strong>1. buntu、Debian或Linux Mint安装Go语言</strong></p> <p>基于 Debian的 Linux 发行版本都可以使用 apt-get 命令来进行安装：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> golang
</code></pre></div><p>要查看当前系统安装的 Go 语言版本可以使用如下命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>go version
</code></pre></div><p>由于 Go 代码必需保存在 workspace(工作区)中，所以我们必需在 <strong>Home</strong> 目录(例如 ~/workspace)创建一个<strong>workspace</strong> 目录并定义 <strong>GOPATH</strong> 环境变量指向该目录，这个目录将被 Go 工具用于保存和编辑二进制文件。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">mkdir</span> ~/workspace
<span class="token keyword">echo</span> <span class="token string">'export GOPATH=&quot;<span class="token variable">$HOME</span>/workspace&quot;'</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
<span class="token function">source</span> ~/.bashrc
</code></pre></div><p>根据不同的需要，我们可以使用 apt-get 安装 Go tools：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> apt-cache search golang
</code></pre></div><p><strong>2. Fedora、CentOS或RHEL安装Go语言</strong></p> <p>基于 Red Hat 的 Linux 发行版本都可以使用 yum 命令来进行安装：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> yum update
<span class="token function">sudo</span> yum <span class="token function">install</span> golang
</code></pre></div><p>要查看当前系统安装的 Go 语言版本可以使用如下命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>go version
</code></pre></div><p>接下来还是在 Home 目录(例如 ~/workspace)创建一个 workspace 目录并定义 GOPATH 环境变量指向该目录，这个目录将被 Go 工具用于保存和编辑二进制文件。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">mkdir</span> ~/workspace
<span class="token keyword">echo</span> <span class="token string">'export GOPATH=&quot;<span class="token variable">$HOME</span>/workspace&quot;'</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
<span class="token function">source</span> ~/.bashrc
</code></pre></div><p>根据不同的需要，我们可以使用 yum 安装 Go tools：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum search golang
</code></pre></div><p>参考资料：<a href="https://studygolang.com/articles/7482" target="_blank" rel="noopener noreferrer">如何为Linux安装Go语言 - Go语言中文网 - Golang中文社区<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="拉取-ffay-lanproxy-go-client-代码"><a href="#拉取-ffay-lanproxy-go-client-代码" aria-hidden="true" class="header-anchor">#</a> 拉取 ffay/lanproxy-go-client 代码</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">git</span> clone https://github.com/ffay/lanproxy-go-client.git
</code></pre></div><h4 id="安装客户端依赖包"><a href="#安装客户端依赖包" aria-hidden="true" class="header-anchor">#</a> 安装客户端依赖包</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">cd</span> lanproxy-go-client
sh build-release.sh
</code></pre></div><p>安装后，这时候在目录下会出现文件。</p> <h4 id="启动客户端"><a href="#启动客户端" aria-hidden="true" class="header-anchor">#</a> 启动客户端</h4> <p><strong>普通端口连接</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># mac 64位</span>
<span class="token function">nohup</span> ./client_darwin_amd64 -s SERVER_IP -p SERVER_PORT -k CLIENT_KEY <span class="token operator">&amp;</span>

<span class="token comment"># linux 64位</span>
<span class="token function">nohup</span> ./client_linux_amd64 -s SERVER_IP -p SERVER_PORT -k CLIENT_KEY <span class="token operator">&amp;</span>

<span class="token comment"># windows 64 位</span>
./client_windows_amd64.exe -s SERVER_IP -p SERVER_PORT -k CLIENT_KEY
</code></pre></div><p><strong>SSL端口连接</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># mac 64位</span>
<span class="token function">nohup</span> ./client_darwin_amd64 -s SERVER_IP -p SERVER_SSL_PORT -k CLIENT_KEY -ssl <span class="token boolean">true</span> <span class="token operator">&amp;</span>

<span class="token comment"># linux 64位</span>
<span class="token function">nohup</span> ./client_linux_amd64 -s SERVER_IP -p SERVER_SSL_PORT -k CLIENT_KEY -ssl <span class="token boolean">true</span> <span class="token operator">&amp;</span>

<span class="token comment"># windows 64 位</span>
./client_windows_amd64.exe -s SERVER_IP -p SERVER_SSL_PORT -k CLIENT_KEY -ssl <span class="token boolean">true</span>
</code></pre></div><p>例如：</p> <div class="language- extra-class"><pre class="language-text"><code>nohup ./client_linux_amd64 -s lp.thingsglobal.org -p 4900 -k 01c1e176d6ee466c8db717a8 &amp;
</code></pre></div><p>命令参数：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>GLOBAL OPTIONS:
   -k value       client key
   -s value       proxy server host
   -p value       proxy server port <span class="token punctuation">(</span>default: 4900<span class="token punctuation">)</span>
   --ssl value    <span class="token function">enable</span> ssl <span class="token punctuation">(</span>default: <span class="token string">&quot;false&quot;</span>, -p value should be server ssl port<span class="token punctuation">)</span>
   --cer value    ssl cert path, default skip verify certificate
   --help, -h     show <span class="token function">help</span>
   --version, -v  print the version
</code></pre></div><h2 id="三、总结"><a href="#三、总结" aria-hidden="true" class="header-anchor">#</a> 三、总结</h2> <p>通过以上的配置，只要有一台公网电脑，即可实现内网穿透功能。摆脱花生壳的域名端口限制，流量限制，带宽限制。笔者的公网服务器为 6M 带宽，通过公网映射，文件下载测试大概在 800K/s - 1.5M/s 范围，如果仅是普通的网站服务完全可以完美穿透。</p> <h2 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://www.fengqiangboy.com/15229403526064.html" target="_blank" rel="noopener noreferrer">基于docker搭建lanproxy内网穿透服务 - 奉强的个人博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/fengqiangboy/lanproxy-docker" target="_blank" rel="noopener noreferrer">lanproxy GitHub 官方主页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/ssooking/p/6094740.html" target="_blank" rel="noopener noreferrer">linux设置开机自启动 - ssooking - 博客园<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/frank-lam/fullstack-tutorial/edit/master/docs/notes/archives/手把手教你，搭建内网穿透服务.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/20/2018, 12:56:39 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/fullstack-tutorial-site/assets/js/app.e23029aa.js" defer></script><script src="/fullstack-tutorial-site/assets/js/40.ffb34422.js" defer></script>
  </body>
</html>
